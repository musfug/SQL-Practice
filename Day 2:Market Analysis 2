with cte as(
 select seller_id, item_id ,order_date,
 rank() over(partition by seller_id order by order_date) as rnk
 from order1),
 
cte2 as(
  select seller_id,item_id from cte where rnk=2 ),
 
 cte3 as(
 select u.user_id as seller_id,favorite_brand,i.item_brand from users u
left join cte2 c on c.seller_id = u.user_id
left join items i on c.item_id=i.item_id)
 
 select seller_id,
 case when favorite_brand=item_brand
 then 'yes'
 else 'no'
 end as result
 from cte3
 
 
 
